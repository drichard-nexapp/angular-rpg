<div class="inventory-panel">
  <app-panel-header [title]="'ðŸ“¦ Inventory - ' + selectedCharacter()!.name" (close)="close()" />
  <div class="inventory-capacity-bar">
    {{ characterInventory().length }}/{{ selectedCharacter()!.inventory_max_items }} slots
  </div>
  <div class="inventory-grid">
    @for (slot of characterInventory(); track slot.slot) {
      <div class="inventory-item">
        <img class="item-image" [alt]="slot.code" [src]="getItemImageUrl(slot.code)" />
        <div class="item-info">
          <div class="item-code">{{ slot.code }}</div>
          <div class="item-quantity">Ã— {{ slot.quantity }}</div>
        </div>
        <div class="item-actions">
          @if (canEquipItem(slot.code)) {
            <button class="equip-item-button" (click)="startEquipItem(slot)">Equip</button>
          }
          <button class="give-item-button" (click)="startGiveItem(slot)">Give</button>
        </div>
      </div>
    }
    @if (characterInventory().length === 0) {
      <div class="empty-message">Inventory is empty</div>
    }
  </div>
  @if (givingItem()) {
    <div class="give-item-dialog">
      <h4>Give {{ givingItem()!.code }}</h4>
      <label>
        Target Character:
        <select [(ngModel)]="giveTargetCharacter">
          @for (char of getOtherCharacters(); track char.name) {
            <option [value]="char.name">{{ char.name }}</option>
          }
        </select>
      </label>
      <label>
        Quantity:
        <input min="1" type="number" [max]="givingItem()!.quantity" [(ngModel)]="giveQuantity" />
      </label>
      <div class="dialog-buttons">
        <button class="confirm-button" (click)="confirmGiveItem()">Confirm</button>
        <button class="cancel-button" (click)="cancelGiveItem()">Cancel</button>
      </div>
    </div>
  }
</div>
