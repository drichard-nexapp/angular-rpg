<div class="gui-layout">
  <div class="gui-header">
    <h1>Maps</h1>
    <div class="layer-selector">
      <label for="layer-select">Layer:</label>
      <select
        id="layer-select"
        [(ngModel)]="currentLayer"
        (ngModelChange)="onLayerChange($event)">
        <option value="overworld">Overworld</option>
        <option value="underground">Underground</option>
        <option value="interior">Interior</option>
      </select>
    </div>
    <app-error-display />
  </div>

  <div class="gui-map-container">
    @if (activeEvents().length > 0) {
      <app-event [activeEvents]="activeEvents()" />
    }

    @if (currentTileDetails()) {
      <app-tile
        [currentTileDetails]="currentTileDetails()!"
        [selectedCharacter]="selectedCharacter()"
        (closeTrigger)="closeTileDetails()" />
    }

    <app-map
      [characters]="characters()"
      [selectedCharacter]="selectedCharacter()"
      [selectedTile]="selectedTile()"
      [currentLayer]="currentLayer()"
      (tileClick)="onTileClick($event)"
      (characterClick)="onCharacterClick($event)" />
  </div>

  <app-character />
</div>
